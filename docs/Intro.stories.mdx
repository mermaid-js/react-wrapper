import { Meta, Canvas } from '@storybook/addon-docs';
import { Mermaid } from '../src';

<Meta title="Mermaid for React" component={Mermaid} />

# Mermaid for React

---

Mermaid for React lets you generate great-looking diagrams from markdown-like text.

<Canvas>
  <Mermaid>{`
    graph LR
    C[Client] <--> LB{{Load Balancer}}
    LB --> A[Server A]
    LB --> B[Server B]
  `}</Mermaid>
</Canvas>

Mermaid for React is a wrapper for the [Mermaid](https://mermaid-js.github.io/mermaid/) diagramming library. It supports all mermaid diagrams including [flowcharts](#flowcharts), [sequence diagrams](#sequence-diagrams), [gantt charts](#gantt-charts), [class diagrams](#class-diagrams), [state diagrams](#state-diagrams) and [more](#pie-chart). It was developed to add diagram support to [Storybook Docs](https://www.npmjs.com/package/@storybook/addon-docs), but it can be used inside _any_ React project.

## Flowcharts

Mermaid's `flowchart` directive is a powerful way to show everything from simple flowcharts to complex topologies. Here's a simple example to start:

<Canvas>
  <Story name="Flow">
    <Mermaid>{`
      flowchart LR
        A[Hard] -->|Text| B(Round)
        B --> C{Decision}
        C -->|One| D[Result 1]
        C -->|Two| E[Result 2]
    `}</Mermaid>
  </Story>
</Canvas>

Here's a directed acyclic graph:

<Canvas>
  <Story name="DAG">
    <Mermaid>{`
      flowchart LR
        a --> b & c--> d
    `}</Mermaid>
  </Story>
</Canvas>

Here's a more complex example with subgraphs:

<Canvas>
  <Story name="Subgraphs">
    <Mermaid>{`
      flowchart TB
        c1-->a2
        subgraph one
        a1-->a2
        end
        subgraph two
        b1-->b2
        end
        subgraph three
        c1-->c2
        end
    `}</Mermaid>
  </Story>
</Canvas>

You are also able to [customize specific styles](https://mermaid-js.github.io/mermaid/#/flowchart?id=styling-a-node) per node:

<Canvas>
  <Story name="CustomStyles">
    <Mermaid>{`
    flowchart LR;
        A[CI MULTI CHAPTCHA]-->B{Select captcha service by developer?};
        classDef green color:#022e1f,fill:#00f500;
        classDef red color:#022e1f,fill:#f11111;
        classDef white color:#022e1f,fill:#fff;
        classDef black color:#fff,fill:#000;
        B--YES-->C[How to use?]:::green;
        
        C-->U[I choose recaptcha.]:::green;
        U--Views-->Q["echo CIMC_JS('recaptcha');\n echo CIMC_HTML(['captcha_name'=>'recaptcha']);"]:::green;
        U--Controller-->W["CIMC_RULE('recaptcha');"]:::green;
        
        C-->I[I choose arcaptcha.]:::white;
        I--Views-->O["echo CIMC_JS('arcaptcha');\n echo CIMC_HTML(['captcha_name'=>'arcaptcha']);"]:::white;
        I--Controller-->P["CIMC_RULE('arcaptcha');"]:::white;
        
        C-->X[I choose bibot.]:::red;
        X--Views-->V["echo CIMC_JS('bibot');\n echo CIMC_HTML(['captcha_name'=>'bibot']);"]:::red;
        X--Controller-->N["CIMC_RULE('bibot');"]:::red;
        
        B--NO-->D[How to use?]:::black;
        D---Views:::black-->F["echo CIMC_JS('randomcaptcha');\n echo CIMC_HTML(['captcha_name'=>'randomcaptcha']);"]:::black; 
        D---Controller:::black-->T["CIMC_RULE('archaptcha,recaptcha,bibot');"]:::black;
    `}</Mermaid>
  </Story>
</Canvas>

The `graph` directive supports a variety of shapes, layout options, and formats. For full documentation, see Mermaid's [flowchart documentation](https://mermaid-js.github.io/mermaid/#/flowchart).

## Sequence diagrams

Mermaid's `sequenceDiagram` visualizes interactions between entities over time. It can be very simple:

<Canvas>
  <Story name="Sequence">
    <Mermaid>{`
      sequenceDiagram
        Alice->>+John: Hey, how are you?
        Alice->>+John: Can you hear me?
        John-->>-Alice: Alice, I hear you!
        John-->>-Alice: I feel great!
    `}</Mermaid>
  </Story>
</Canvas>

And also an add [pop-up menus with hyperlinks](https://mermaid-js.github.io/mermaid/#/sequenceDiagram?id=actor-menus), hover on the top nodes to see:

<Canvas>
  <Mermaid>{`
sequenceDiagram
    participant Alice
    participant John
    links Alice: {"Dashboard": "https://dashboard.contoso.com/alice", "Wiki": "https://wiki.contoso.com/alice"}
    links John: {"Dashboard": "https://dashboard.contoso.com/john", "Wiki": "https://wiki.contoso.com/john"}
    Alice->>John: Hello John, how are you?
    John-->>Alice: Great!
    Alice-)John: See you later!
  `}</Mermaid>
</Canvas>

And can also have complex self-loops, notes, and numbered events:

<Canvas>
  <Story name="Complex Sequence">
    <Mermaid>{`
      sequenceDiagram
        autonumber
        Alice->>John: Hey, how are you?
        loop Reflecting
          John->>John: 
        end
        John-->>Alice: Great!
        John->>Bob: How about you?
        Note right of Bob: Go Bob! ðŸš€
        Bob-->>John: Jolly good!
    `}</Mermaid>
  </Story>
</Canvas>

The `sequenceDiagram` directive supports a variety of shapes, options, and interactions. For full documentation, see Mermaid's [sequence documentation](https://mermaid-js.github.io/mermaid/#/sequence).

## Gantt charts

<Canvas>
  <Story name="Gantt">
    <Mermaid>{`
      gantt
        title Storybook release plan
        dateFormat  YYYY-MM-DD
        section Doc blocks
        Depdendencies :done,   a1, 2020-01-05, 15d
        Mermaid       :active, a2, after a1,   10d
        Code sandbox  :, after a2,   20d
        section Composition
        Basics          :active, 2020-01-12, 24d
        Authentication  : 12d
    `}</Mermaid>
  </Story>
</Canvas>

## Class diagrams

<Canvas>
  <Story name="Class">
    <Mermaid>{`
      classDiagram
        classA <|-- classB
        classC o-- classD
        classE <.. classF
        classG *.. classH
        classI .. classJ
        Animal <|-- Duck
        Animal <|-- Fish
        Animal <|-- Zebra
        Animal : +int age
        Animal : +String gender
        Animal: +isMammal()
        Animal: +mate()
        class Duck{
          +String beakColor
          +swim()
          +quack()
        }
        class Fish{
          -int sizeInFeet
          -canEat()
        }
        class Zebra{
          +bool is_wild
          +run()
        }
    `}</Mermaid>
  </Story>
</Canvas>

## State diagrams

<Canvas>
  <Story name="State">
    <Mermaid>{`
      stateDiagram
        [*] --> Still
        Still --> [*]
        Still --> Moving
        Moving --> Still
        Moving --> [*]
    `}</Mermaid>
  </Story>
</Canvas>

## User journey

<Canvas>
  <Story name="Journey">
    <Mermaid>{`
      journey
        title My working day
        section Go to work
          Make tea: 5: Me
          Go upstairs: 3: Me
          Do work: 1: Me, Cat
        section Go home
          Go downstairs: 5: Me
          Sit down: 3: Me
    `}</Mermaid>
  </Story>
</Canvas>

## Pie chart

<Canvas>
  <Story name="PieChart">
    <Mermaid>{`
      pie title Pets adopted by volunteers
        "Dogs" : 386
        "Cats" : 85
        "Rats" : 15
    `}</Mermaid>
  </Story>
</Canvas>

## Entity Relationship

<Canvas>
  <Story name="EntityRelationship">
    <Mermaid>{`
      erDiagram
        CUSTOMER }|..|{ DELIVERY-ADDRESS : has
        CUSTOMER ||--o{ ORDER : places
        CUSTOMER ||--o{ INVOICE : "liable for"
        DELIVERY-ADDRESS ||--o{ ORDER : receives
        INVOICE ||--|{ ORDER : covers
        ORDER ||--|{ ORDER-ITEM : includes
        PRODUCT-CATEGORY ||--|{ PRODUCT : contains
        PRODUCT ||--o{ ORDER-ITEM : "ordered in"
    `}</Mermaid>
  </Story>
</Canvas>

## Git graph (experimental)

<Canvas>
  <Story name="Git">
    <Mermaid>{`
gitGraph:
options
{
  "nodeSpacing": 120,
  "nodeRadius": 10
}
end
commit
branch newbranch
checkout newbranch
commit
commit
checkout master
commit
merge newbranch
    `}</Mermaid>
  </Story>
</Canvas>
